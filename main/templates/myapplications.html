{% extends "main.html" %}

{% block content %}
<div class="container-fluid p-5">
    <h1 class="mb-4">My Applications</h1>
    {% if "userSession" not in response %}
    <div class="container-fluid py-3">
        <div class="d-flex row justify-content-center">
            <div class="col">
                <div class="col border-end border-3" style="background-color:#f5f8fe;">
                    <div class="d-flex container mt-3 justify-content-center align-content-center flex-wrap"
                        style="min-height:90%;">
                        <div class="card mb-3" style="width:400px">
                            <div class="card-body">
                                <h5 class="card-title">Sign In here, </h5>
                                <h6 class="card-subtitle mb-2 text-muted">To view and manage your applications.</h6>
                                <p class="card-text">
                                <div className="login-wrapper">
                                    <form
                                        action="/login?returnUrl={{ request.path if request.path != '/login' else '/' }}"
                                        method="POST" autocomplete="off">

                                        <div class="form-group">
                                            <label for="username">Username / Email</label>
                                            <input type="text" class="form-control" id="login-username" name="username"
                                                aria-describedby="usernameHelp" placeholder="jdean@example.com">
                                            <small id="usernameHelp" class="form-text text-muted"></small>
                                        </div>

                                        <div class="form-group">
                                            <label for="password">Password</label>
                                            <input type="password" class="form-control" id="login-password"
                                                name="password" aria-describedby="passwordHelp" placeholder="">
                                            <small id="passwordHelp" class="form-text text-muted"></small>
                                        </div>

                                        <button type="submit" class="btn btn-primary">Sign In</button>

                                    </form>
                                </div>
                                </p>
                            </div>
                            {% if "messages" in response %}
                            {% if "ERROR" in response["messages"] %}
                            <div class="alert alert-warning mb-0" role="alert">
                                {{ response["messages"] }}
                            </div>
                            {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding-top:200px;">-OR-</div>

            <div class="col">
                <div class="col border-end border-3" style="background-color:#f5f8fe;">
                    <div class="d-flex container mt-3 justify-content-center align-content-center flex-wrap"
                        style="min-height:90%;">
                        <div class="card mb-3" style="width:450px">
                            <div class="card-body">
                                <h5 class="card-title">Don't have an account ?</h5>
                                <h6 class="card-subtitle mb-2 text-muted">Register here to start your job application
                                    process.</h6>
                                <p class="card-text">
                                <div className="login-wrapper">
                                    <form
                                        action="/register?returnUrl={{ request.path if request.path != '/login' else '/' }}"
                                        method="POST" autocomplete="off">
                                        <div class="form-group d-flex flex-row ">
                                            <div class="col-xs-3">
                                                <label for="first_name">First Name</label>
                                                <input type="text" class="form-control" id="first_name"
                                                    name="first_name" type="text"
                                                    value="{{response['formData']['first_name']}}">
                                            </div>
                                            <div class="col-xs-4 flex-grow-1 ml-4">
                                                <label for="last_name">Last Name</label>
                                                <input type="text" class="form-control" id="last_name" name="last_name"
                                                    type="text" value="{{response['formData']['last_name']}}" required>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="username">Email</label>
                                            <input type="text" class="form-control" id="registration-username"
                                                name="username" aria-describedby="usernameHelp"
                                                placeholder="jdean@example.com"
                                                value="{{response['formData']['username']}}" required>
                                            <small id="usernameHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group">
                                            <label for="password">Password</label>
                                            <input type="password" class="form-control" id="registration-password"
                                                name="password" aria-describedby="passwordHelp" placeholder="" required>
                                            <small id="passwordHelp" class="form-text text-muted"></small>
                                        </div>

                                        <button type="submit" class="btn btn-primary">Create Account</button>
                                    </form>
                                </div>
                                </p>
                            </div>
                            {% if "messages" in response %}
                            {% if "ERROR" in response["messages"] %}
                            <div class="alert alert-warning mb-0" role="alert">
                                {{ response["messages"] }}
                            </div>
                            {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    {% if "payroll" in response and response["payroll"] != None %}

    <table class="table table-sm table-hover table-bordered shadow-sm text-center mt-2">
        <thead>
            <tr class="text-center" style="background-color:#D6EAF8">
                <th scope="col" colspan="2" style="width:10%">Action</th>
                <th scope="col">Username</th>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
                <th scope="col">Email</th>
            </tr>
        </thead>
        <tbody>
            {% for item in response["payroll"] %}
            <tr>
                <td class="text-center"><a href="#edit"><i class="fa-solid fa-edit fa-flip-horizontal "></i></a>
                </td>
                <td class="text-center"><a href="#delete"><i class="fa-solid fa-trash fa-flip-horizontal"></i></a>
                </td>
                <td>{{item.username}}</td>
                <td>{{item.first_name}}</td>
                <td>{{item.last_name}}</td>
                <td>{{item.email}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-muted">
        No applications found. Go to <a href="/jobs" id="navJobsButton">"Job Listings"</a> to apply for a job.
    </p>
    {% endif %}

    {% endif %}
</div>
{% endblock content %}